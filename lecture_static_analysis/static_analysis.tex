\errorcontextlines=9999
\documentclass[
   aspectratio=169, % default is 43
   10pt, % font size, default is 11pt
   % nosectionframes,
   uniqueslidenumber,
   sectiontitleslides,
   % handout,
   professionalfonts
]{beamer}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[sfdefault]{FiraSans}

\usepackage{stmaryrd}
\usepackage[vvarbb]{notomath}
\usepackage{FiraMono}
\usepackage{tikz,forest}
\usepackage{fontawesome}
\usepackage{csquotes}
\usepackage{multicol}
\usepackage{../simplebnf}
\usepackage{../abstract-interpretation-ltx/absint}
\makeatletter
\def\absint@reflab#1#2{#2}% we do not need labels here
\usetikzlibrary{arrows.meta,decorations.pathmorphing,fit,decorations.pathreplacing,backgrounds,matrix,shadows}
\pgfdeclarelayer{foreground}
\usepackage{tikzpingus}
\pgfsetlayers{very-background,background,main,middle,foreground}
\def\sbseries{\fontseries{sb}\selectfont}
\def\textsb#1{{\sbseries#1}}

\usepackage{../slide-template-uulm/fancybeamer} % use the fancy beamer package
\usepackage{../slide-template-uulm/fancyuulm}
\setpaths{{../slide-template-uulm/}{../slide-template-uulm/logos/}{../slide-template-uulm/empty-slides/}{../xlistings/}}

\usepackage{../code-animation/code-animation}
\usepackage[fakeminted,print]{../xlistings/xlistings}
\usepackage{multirow}
\xlstsetmintedstyle{plain}
\LoadLanguages{R,Java}
\lstcolorlet{keywordA}{black!70!red}%
\lstcolorlet{keywordB}{black!70!red}%
\lstcolorlet{keywordC}{black!70!red}%
\lstcolorlet{numbers}{black!70!yellow}%
\def\absintstyle#1{#1}

% bib
\usepackage[style=alphabetic,backend=biber]{biblatex}
\addbibresource{./references.bib}

\newsavebox\SimpleSignLattice
\begin{lrbox}{\SimpleSignLattice}
\scriptsize
\begin{tikzpicture}[line cap=round,x=6.5mm,y=6.5mm]
   \node (top) at (0,0) {\absexpr{\top}};
   \node (pos) at (-1,-1) {\absexpr{\geq 0}};
   \node (neg) at (1,-1) {\absexpr{\leq 0}};
   \node (zero) at (0,-2) {\absexpr{0}};
   \node (bot) at (0,-3) {\absexpr{\bot}};
   \draw (top) -- (pos) -- (zero) -- (neg) -- (top) (zero) -- (bot);
\end{tikzpicture}
\end{lrbox}

\def\LeftArrow{\text{\BeginAccSupp{method=escape,ActualText={<-}}\(\leftarrow\)\EndAccSupp{}}}
\def\RightArrow{\text{\BeginAccSupp{method=escape,ActualText={->}}\(\rightarrow\)\EndAccSupp{}}}
\def\DoubleLeftArrow{\text{\BeginAccSupp{method=escape,ActualText={<<-}}\(\twoheadleftarrow\)\EndAccSupp{}}}
\def\DoubleRightArrow{\text{\BeginAccSupp{method=escape,ActualText={->>}}\(\twoheadrightarrow\)\EndAccSupp{}}}
\lstset{add to literate={<-}{{{\!\LeftArrow\!}}}2
   {<<-}{{{\!\DoubleLeftArrow\!}}}2
   {->}{{{\!\RightArrow\!}}}2
   {->>}{{{\!\DoubleRightArrow\!}}}2
}
\makeatletter
\def\ca@Strut{%
    \vphantom{%
        \xlst@font@fs@normal\xlst@styles@lst@basic\strut
    }%
}

\def\supercite#1{\raisebox{-1pt}{\textsuperscript{\footnotesize\color{gray}\cite{#1}}}}

\def\AbstractInfo#1{\ensuremath{\mathcolor{gray}{\Lbag}\,#1\,\mathcolor{gray}{\Rbag}}}
\def\Set#1{\ensuremath{\{#1\kern1pt\}}}
\def\IntCC#1#2{\ensuremath{[#1\,..\,#2]}}
\def\IntOC#1#2{\ensuremath{(#1\,..\,#2]}}
\def\IntCO#1#2{\ensuremath{[#1\,..\,#2)}}
\def\IntOO#1#2{\ensuremath{(#1\,..\,#2)}}
\def\S#1{\savebox\TestBox{\footnotesize\absexpr{\Set{#1}}}\ifdim\ht\TestBox>5mm\makebox[5mm][c]{\usebox\TestBox}\else\usebox\TestBox\fi}%
\def\I#1#2{\footnotesize\absexpr{\IntCC{#1}{#2}}}

\tikzset{
    path image shift/.style={}, % scale patch just for white padding
    path image/.style={path picture={\node[scale=.98] at ([path image shift]path picture bounding box.center) {#1};}}
}

\title[Static Analysis]{A Primer on Static Code Analysis}
\subtitle[SQA]{Software Quality Assurance --- Static Code Analysis, I}
\author[F. Sihler]{Florian Sihler}
\date{December 3, 2025}

\fancylogos{sp,uulm}

\usepackage{../beamer-latex-pdfpc-notes}


% TODO: take perspectives slide from thing for tubs
\begin{document}

\maketitle[titleimage/title][40]

% \mode
% <handout>

% \begin{frame}{Outline}
% % \begin{multicols}{2}
% \tableofcontents[hideallsubsections]
% % \end{multicols}
% \end{frame}

% \mode
% <all>

\tikzset{
   RectRounding/.style={rounded corners=3pt},
   RawRect/.style={
      draw=black,
      rectangle,
      RectRounding,
      minimum size=1.8em,
      inner sep=5pt,
      fill=white,
   },
   Rect/.style={
      draw=black,
      rectangle,
      RectRounding,
      outer sep=2pt,
      minimum size=1.8em,
      fill=white,
      drop shadow={fill=lightgray!50}
   },
   Soft/.style={line join=round,line cap=round},
   Link/.style={
      draw,
      Soft,
      rounded corners=2.5pt,
      -Kite
   },
   na/.style={midway,above,font=\scriptsize,align=center},
   base@l/.style 2 args={edge node={node[na,#2]{#1}}},
   l/.style={base@l={#1}{}},
   lr/.style={base@l={#1}{right,align=left}},
   ll/.style={base@l={#1}{left,align=right}},
   lb/.style={base@l={#1}{below}},
}
\newsavebox\Landscape
\begin{frame}{Embedding a Landscape}
\begin{lrbox}{\Landscape}   
\begin{tikzpicture}[
   Rect/.append style={minimum height=3.25em,text width=6.5em,align=center}
]
   \node[Rect] (req) at (0,0) {Requirements};
   \node[Rect,right=1.5cm] (var) at (req.east) {Variability\\Req.};
   \node[Rect,right=1.5cm] (form) at (var.east) {Formal\\Req.};
   \node[Rect,below=6mm] (source) at(var.south) {Source\\Code};
   \path (req) -- (var) coordinate[pos=.5] (r2v);
   \path (var) -- (form) coordinate[pos=.5] (v2f);
   \node[Rect,below=6mm] (gui) at([xshift=-3.5mm]source.south-|r2v) {GUI Test\\Cases};
   \node[Rect,below=6mm] (test) at([xshift=3.5mm]source.south-|v2f) {Test\\Cases};
   \draw[Link] (req) to[l={Modeling}] (var);
   \draw[Link] (req.north) -- ++(0,3.5mm) to[l={Modeling/Formalization (Statecharts,~\ldots)}] ([yshift=3.5mm]form.north) -- (form.north);
   \draw[Link] ([yshift=-2mm]form.north east) -- ++(3mm,0) to[lr={Model\\Checking}] ([yshift=2mm,xshift=3mm]form.south east) -- ([yshift=2mm]form.south east);
   \draw[Link] (form.south) |- (test) node[na,pos=.25,right,align=left] {Model-Based Test\\Case Generation};
   \draw[Link] (var) -| (test) node[na,pos=.75,right,align=left] {Feature\\Interaction\\Testing};
   \draw[Link] (test.160) -| ([xshift=-8.5mm]source.south east) node[na,pos=.25,below] {Tests};
   \draw[Link] (gui.20) -| ([xshift=8.5mm]source.south west) node[na,pos=.25,below] {Tests};
   \draw[Link] (gui) -| (req.south) node[na,pos=.75,left,align=right] {Automated\\User-Interface\\Testing};
   \draw[Link,Kite-] ([yshift=-2mm]req.north west) -- ++(-3mm,0) to[ll={Dep.\\Req.}] ([yshift=2mm,xshift=-3mm]req.south west) -- ([yshift=2mm]req.south west);
   \draw[Link] (req.300) |- (source) node[na,pos=.75,below] {Implementation};
   \draw[Link] ([xshift=-2mm]test.south east) -- ++(0,-3mm) to[lb={Mutation, Property-Based,\\Prioritization}] ([xshift=2mm,yshift=-3mm]test.south west) -- ([xshift=2mm]test.south west);
   \tikzset{@/.style={}}
   \only<3->{
      \tikzset{@/.style={red,thick,font=\bfseries}}
   }
   \draw[Link,Kite-,@] ([xshift=-8.5mm]source.north east) -- ++(0,3.5mm) 
      -- ([xshift=8.5mm,yshift=3.5mm]source.north west) 
         node[na,yshift=-1.85mm,pos=1,left,align=right] (s) {~~~\strut Static}
         node[na,yshift=-1.85mm,pos=0,right,align=left] (a) {\,\strut Analysis}
      -- ([xshift=8.5mm]source.north west);
   \only<3->{
      \pgfonlayer{background}
      \node[fit={(s)(a)(source)},inner sep=1.5pt,draw,red,very thick,rounded corners=2pt,inner ysep=2.5pt,yshift=-1pt,fill=red!5] {};
      \endpgfonlayer
   }
\end{tikzpicture}
\end{lrbox}
\begin{tikzpicture}[overlay,remember picture]
   \onslide<2->{\node[yshift=-5mm] at(current page.center) {\usebox\Landscape};}
\end{tikzpicture}
\end{frame}

\newsavebox\PinguBox
\savebox\PinguBox{\tikz{\pingu[right wing shock, left eye wink, body type=legacy,left wing wave,name=pingu,heart]; \node[above] at (pingu-wing-left-tip) {\huge\faQuestion};}}
\newsavebox\PinguBoxB
\savebox\PinguBoxB{\tikz{\pingu[right wing shock, eyes shiny, body type=legacy,tie=pingu@purple,left wing wave,name=pingu,heart]; \node[above] at (pingu-wing-left-tip) {\huge\faQuestion};}}
\begin{frame}{}

\begin{tikzpicture}[overlay,remember picture]
   \def\shiftup{12mm}
   \only<9->{\def\shiftup{28mm}}
   \onslide<2->{\node[right=4mm,yshift=\shiftup] (@) at (current page.west) {\scalebox{.65}{\usebox\PinguBox}};}
   \onslide<3->{
      \node[below right,yshift=-2.5mm,xshift=2mm] (@) at (@.north east) {\textbf{\large What} is static {\only<4->{\color{lightgray}}code} analysis?};
   }
   \onslide<5->{
      \node[below=12.75mm,align=center,font=\large] at(current page.center|-@.south) {Discover \textit{\subnode{desc@syntactic-properties}{syntactic}/\subnode{desc@semantic-properties}{semantic} properties} of programs\\\subnode{desc@no-execute}{\textsb{without}} running them.\rlap{\supercite{rival2020introduction}}};
   }
   \onslide<6->{
      \draw[gray,Link] (desc@syntactic-properties.north) to[out=80,in=180] ++(7mm,11mm) node[below right,yshift=.6\baselineskip,align=left,font=\small] {%
         % syntactic:
         Derivable purely on program syntax.\\[-3.5pt]
         \scriptsize e.g., Line-Counts, Indentation, Parameter-Counts, \ldots
      };
   }
   \onslide<7->{
      \draw[gray,Link] (desc@semantic-properties.north) to[out=80,in=180] ++(7mm,4.5mm) node[below right,yshift=.6\baselineskip,align=left,font=\small] {%
         % semantic:
         Derivable from program semantics (behavior).\\[-3.5pt]
         \scriptsize e.g., Possible Variable Values, Termination,~\ldots
      };
   }
   \onslide<8->{
      \draw[gray,Link] (desc@no-execute) to[out=270,in=180] ++(7mm,-7.75mm) node[below right,yshift=.6\baselineskip,align=right,font=\small] {%
         Reason on \textit{all} possible executions.
      };
   }
   \onslide<10->{
      \node[right=4mm,yshift=-17mm] (@b) at (current page.west) {\scalebox{.65}{\usebox\PinguBoxB}};
      \node[below right,yshift=-2.5mm,xshift=2mm] (@b) at (@b.north east) {\textbf{\large Why} do static analysis?};
   }
   \onslide<11->{
      \node[below=10.75mm,text width=10cm,align=center,font=\footnotesize] at(current page.center)
      {%
      \begin{multicols}{2}
         \begin{itemize}
            \item Find bugs or vulnerabilities
            \item<12-> Prove correctness
            \item<13-> Find and apply optimizations
            \item<14-> Follow \rlap{coding guidelines\,/\,style guides}
            \item<15-> Refactoring support
            \item<16-> \ldots\hfill\llap{\textcolor{lightgray}{(it is fun!)}}
         \end{itemize}
      \end{multicols}
      };
   }
\end{tikzpicture}
\end{frame}

\savebox\PinguBox{%
   \tikz{\pingu[%
      eyes wink,
      wings wave,
      magnifier left,
      glasses,
      pants=pingu@red,
      pants bands
   ]}
}

\begin{frame}{Let's find some bugs!}
\begin{tikzpicture}[overlay,remember picture]
   \def\shiftleft{0mm}
   \only<11->{\def\shiftleft{-40mm}}
   \onslide<2->{
      \node[align=center] (@) at([yshift=-3.25mm,xshift=\shiftleft]current page.center) {\scalebox{.65}{\usebox\PinguBox}\\Let's test!~\strut};  
   }
   \onslide<3->{
      \node[above right,xshift=-9mm] at(@.north east) {\large Dynamic};
   }
   \onslide<4->{
      \node[below right,xshift=-1mm] at(@.east) {\large Practical};
   }
   \onslide<5->{
      \node[above left] at(@.south west) {\large Quick};
   }
   \onslide<6->{
      \node[left] at(@.north west) {\large Easy};
   }
   \onslide<7->{
      \fill[white,opacity=.75] (@.center) circle[radius=3cm];
      \node[yshift=-2mm] at(@.north) {\huge But\only<8->{\rlap{\smash{,}}}};
   }
   \onslide<8->{
      \node[yshift=2mm] at(@) {\huge Tests are};
      \node[yshift=6mm] (@inc) at(@.south) {\huge\bfseries Incomplete!};
   }
   \onslide<9->{
      \tikzset{@/.style={}}
      \only<10->{\tikzset{@/.style={opacity=.15}}}
      \node[below,@] (@sout) at(@inc.south) {\textit{System.out.println}?};
   }
   \onslide<10->{
      \node at(@sout) {\itshape\bfseries Nope};
   }
   \onslide<12->{
      \node[right=.5mm,align=center,text width=7cm,font=\large] at(current page.center) {\enquote{Program testing can be used to show the presence of bugs, but never to show their absence!}\\[2pt]\normalsize\citeauthor{dijkstra1969notes}\rlap{\supercite{dijkstra1969notes}}};
   }
\end{tikzpicture}
\end{frame}

\usetikzlibrary{backgrounds,graphs,arrows.meta,decorations.pathreplacing}
\definecolor{BaseGray}{RGB}{66,66,66} % rgb(66,66,66)

\colorlet{SoftGray}{BaseGray!40}
\colorlet{BackGray}{BaseGray!5}
\colorlet{SoftTextGray}{BackGray!60!SoftGray}


\tikzset{
   FunctionDef/.style={
      draw=BaseGray,
      fill=BaseGray,
      minimum width=1.55cm,
      minimum height=1cm,
      text=white,
      font=\bfseries,
      text centered,
      inner sep=0pt,
      rounded corners=1mm,
      outer sep=2pt
   },
   Blob/.style={
      draw=SoftGray,
      fill=SoftGray,
      minimum size=4mm,
      text=white,
      circle,
      font=\bfseries,
      text centered,
      inner sep=0pt,
      outer sep=2pt
   },
   Def/.style={
      Blob,
      rectangle, rounded corners=1mm
   },
   ActiveBlob/.style={
      Blob,
      draw=BaseGray!80!white, fill=BaseGray!80!white
   },
   FunctionBack/.style={
      fill=BackGray,
      % draw=SoftGray,
      rounded corners=2mm,
      rectangle
   },
   Link/.style={
      draw=SoftGray,
      line width=1.5pt,
      line cap=round,
      line join=round,
      -%
   },
   FuncLink/.style={
      Link,
      draw=SoftGray,
      dotted
   },
   Cursor/.style={
      fill=BackGray,
      draw=BaseGray,
      line join=round,
      line cap=round
   },
   Hover-Over/.style={
      fill=BackGray,
      draw=SoftGray,
      opacity=.5,
      draw opacity=1,
      rounded corners=1mm,
      line join=round,
      line cap=round
   },
   Line-Of-Text/.style={
      fill=#1,
      draw=none,
      rounded corners=1.5pt,
      inner sep=1pt,
      minimum width=1cm,
      minimum height=6.5pt
   },
   Input-Base/.style={
      fill=BackGray,
      draw=SoftGray,
      rounded corners=1mm,
      inner sep=1pt,
      minimum width=2cm,
      minimum height=12pt
   },
   % code sub-styles
   A/.style={Line-Of-Text=SoftTextGray},
   B/.style={},
   C/.style={Line-Of-Text=SoftGray},
   path image shift/.style={},
   path image/.style 2 args={path picture={\node at ([path image shift]path picture bounding box.center) {\includegraphics[width=#2]{#1}};}},
}


\newcommand\Back[4][]{
   \pgfonlayer{background}
   \fill[FunctionBack,#1] ([xshift=-2mm,yshift=-2mm]#2.south west) rectangle ([xshift=2mm,yshift=2mm]#3.north east);
   \coordinate (#4@north) at([yshift=2mm]0,0|-#3.north);
   \coordinate (#4@west) at([xshift=-2.5mm]0,0-|#2.west);
\endpgfonlayer
}
\newsavebox\UiBox
\begin{lrbox}{\UiBox}
\begin{tikzpicture}
   \node[FunctionDef] (F) at (0,0) {};

   \scope[shift={(F.south)},yshift=-1.5cm]
      \node[Def] (a1) at (-1,0) {};
      \node[Blob] (b1) at (.5,-.25) {};
      \node[ActiveBlob] (c1) at (1.55,-1.35) {};
      \node[Blob] (d1) at (-0.5,-1.6) {};
      \node[Blob] (e1) at (1.8,.25) {};
      \node[Blob] (f1) at (-2.2,-1.5) {};

      \graph[edges={Link}] {
         (a1) -> { (b1), (c1) } -> (d1) -> (e1) -> (a1),
         (f1) -> { (a1), (d1) }
      };

      \Back{f1}{e1}{f1}

      \draw[FuncLink] (f1@north) -- (F.south);
   \endscope

   \node[Blob] (a) at (2.5,0) {};
   \node[Blob] (b) at (1.5,1) {};
   \node[Blob] (c) at (3,2) {};
   \node[Blob] (d) at (-2.5,0.5) {};
   \node[Def] (e) at (-2.5,1.5) {};
   \node[Blob] (f) at (-3,2.5) {};
   \node[Blob] (g) at (-3.5,-1) {};
   \node[Blob] (h) at (-3,-2.5) {};

   \node[FunctionDef] (F2) at(5,-.5) {};
   \node[Blob] (u) at(5.5,1) {};

   \scope[shift={(F2.east)},xshift=1.5cm]

      \node[Blob] (a2) at (0,1.15) {};
      \node[Def] (b2) at (.75,1.85) {};
      \node[Blob] (c2) at (-.5,-.85) {};

      \node[Blob] (d2) at (1.33,0.25) {};
      \node[FunctionDef] (e2) at (2,-.75) {};

      \node[Blob] (f2) at (3.75,1.5) {};
      \node[Blob] (g2) at (2.75,2.5) {};

      \scope[shift=(e2.south), yshift=-1cm]
         \node[ActiveBlob] (a3) at (-1,0) {};
         \node[Blob] (b3) at (1,0) {};
         \draw[Link] (a3) -- (b3);
         \Back[white]{a3}{b3}{a3} % for coordinate
      \endscope

      \coordinate (ll) at ([yshift=-2mm]a3.south west-|c2.west);
      \coordinate (ur) at (f2.north east|-g2.north);

      \Back{ll}{ur}{e2}
      \draw[FuncLink] (e2@west) -- (F2.east);

      % draw inner later
      \Back[white]{a3}{b3}{xx} % for the overlay :D
      \draw[FuncLink] (a3@north) -- (e2.south);

      \graph[edges={Link}] {
         (a2) -> (b2) -> { (c2) , (d2) },
         (d2) -> { (e2), (f2) },
         (f2) -> (g2),
         (c2) -> (a3)
      };
   \endscope

   \graph[edges={Link}] {
      (F) -> { (a), (b) },
      (a) -> (e1),
      (b) -> (c) -> (b2),
      (b) -> (d) -> { (F), (e) },
      (e) -> (f) -> (c),
      (d) -> (g) -> (h) -> (f1),
      (u) -> (F2)
   };

   \coordinate (cursor-pos) at ([xshift=-1.65mm,yshift=2mm]F2.south east);
   \draw[Cursor,rotate around={28:(cursor-pos)}]  [rounded corners=2.25pt] (cursor-pos)  [rounded corners=2.25pt] -- ++(4pt,-9.5pt) [rounded corners=2pt] -- ++(-4pt,3pt) [rounded corners=2.25pt]-- ++(-4pt,-3pt) -- cycle;
   \node[below left,xshift=-1mm,yshift=1.15mm,Hover-Over,minimum width=1.25cm,minimum height=6mm] (hoverover) at(cursor-pos) {%
      %
   };
   % \scope[opacity=.95,transparency group]
      \fill[Line-Of-Text=SoftGray] ([shift={(2pt,-2pt)}]hoverover.north west) rectangle ++(7.5mm,-4pt);
      \fill[Line-Of-Text=SoftTextGray] ([shift={(2pt,-7.5pt)}]hoverover.north west) rectangle ++(11mm,-3pt);
      \fill[Line-Of-Text=SoftTextGray] ([shift={(2pt,-7.5pt-4.5pt)}]hoverover.north west) rectangle ++(8mm,-3pt);
   % \endscope

   % TODO: outsource window?
   \coordinate (wul) at ([shift={(-5mm,6mm)}]current bounding box.north west);
   \coordinate (wur) at ([shift={(5mm,6mm)}]current bounding box.north east);
   \draw[thin,rounded corners=3pt,SoftGray] ([shift={(-5mm,-5mm)}]current bounding box.south west) rectangle (wur);
   % just "overlay" the top :D
   \filldraw[SoftGray] ([yshift=-1mm]wul) coordinate (@) -- (wur|-@) [rounded corners] |- ([yshift=2.5mm]wul) [sharp corners] -- cycle;

   \fill[Line-Of-Text=BackGray] ([yshift=1.35mm,xshift=4pt]wul) rectangle ++(2cm,-1.27mm);
   \node[above left,BackGray] at([yshift=-1.33mm,xshift=-1mm]wur) {\smash{\scalebox{.9}{\scriptsize\faAngleDown~~\faAngleUp~~\faTimesCircle}}};

   \coordinate (root control window) at(current bounding box.south west);

   \scope[shift={(current bounding box.south east)},shift={(-7cm,4.5mm)}]
      \coordinate (wul) at (0,0);
      \coordinate (wur) at (8.5,0);

      \draw[thin,rounded corners=3pt,SoftGray,fill=white] (0,-5) rectangle (wur);

      % code line
      \draw[thin,BackGray] ([xshift=1cm,yshift=-1mm]wul) coordinate (@) -- (@|-0,-5);
      % line numbers and code
      \foreach[count=\i from 0] \Code in {
         {1/A,0.5/A,5/C,2/A},
         {1.5/B,3/A,0.5/A,2/A},
         {},
         {1.5/B,0.5/A,3/A},
         {1/A},
         {},
         {5/A,0.5/A,2/A},%
         {0.5/A,5/A,3/A,0.5/A,2/A,5.5/A},
         {},
         {1/C,0.5/A,1/A,0.5/A,1/A,0.5/A,0.15/B,0.5/A},
         {1.5/B,3/A,0.5/A,1/C,2/A,1.5/A,1/C,1.5/A},
         {1.5/B,0.75/A,0.5/A,1.5/A,0.5/A,1/A},
         {1.5/B,3/A,0.5/A,2/A},
         {1.5/B,2/A,0.5/A,2/A},
         {1/A}%
      } {
         \ifnum\i<6 \def\Width{4mm} \else \def\Width{6mm} \fi
         \fill[Line-Of-Text=BackGray] ([yshift=-1mm,xshift=8mm]wul|-0,-\i*0.33*10mm+1mm) rectangle ++(-\Width,-2mm);
         \def\XShift{5}
         \foreach \CW/\Style in \Code {
            \ifstrequal{\Style}{B}{\def\RandomSuffix{0}}{\def\RandomSuffix{(rand*0.4mm+0.75mm)}}
            \pgfmathsetmacro\w{3*\CW mm+\RandomSuffix}
            \path[\Style] ([yshift=-1mm,xshift=1cm+\XShift pt]wul|-0,-\i*0.33*10mm+1mm) rectangle ++(\w pt,-2mm);

            \pgfmathsetmacro{\XShift}{\XShift+\w pt+1.5mm}
            \xdef\XShift{\XShift}
         }
      }

      % slider
      \draw[Line-Of-Text=SoftTextGray,rounded corners=.325mm] ([yshift=-4cm+5mm,xshift=-1mm]wur) rectangle ++(-.75mm,-1cm);

      % just redraw the frame :D
      \draw[thin,rounded corners=3pt,SoftGray] (0,-5) rectangle (wur);

      \filldraw[SoftGray] ([yshift=-1mm]wul) coordinate (@) -- (wur|-@) [rounded corners] |- ([yshift=2.5mm]wul) [sharp corners] -- cycle;

      \fill[Line-Of-Text=BackGray] ([yshift=1.35mm,xshift=4pt]wul) rectangle ++(1.66cm,-1.27mm);
      \node[above left,BackGray] at([yshift=-1.33mm,xshift=-1mm]wur) {\smash{\scalebox{.9}{\scriptsize\faAngleDown~~\faAngleUp~~\faTimesCircle}}};

   \endscope

   % window for controls
   \scope[shift={(root control window)},shift={(-1cm,-5mm)}]
      \draw[thin,rounded corners=3pt,SoftGray,fill=white] (0,-4) rectangle ++(8.33cm,4cm);
      \coordinate (wul) at (0,0);
      \coordinate (wur) at (8.33,0);

      \node[Input-Base,minimum width=6cm,below right=3mm] (slice-criterion-input) at (wul) {};
      \fill[Line-Of-Text=SoftTextGray] ([yshift=1mm,xshift=4pt]slice-criterion-input.west) rectangle ++(1.25cm,-2mm);
      \fill[Line-Of-Text=SoftTextGray] ([yshift=1mm,xshift=4pt+1.25cm+2mm]slice-criterion-input.west) rectangle ++(1cm,-2mm);

      % frame stuff
      \filldraw[SoftGray] ([yshift=-1mm]wul) coordinate (@) -- (wur|-@) [rounded corners] |- ([yshift=2.5mm]wul) [sharp corners] -- cycle;
      \node[right=1mm,SoftGray,] at(slice-criterion-input.east) {\tiny\faChevronRight~~~~~\faPieChart~~\faUpload~~\faDownload};

      % logging window
      \draw[rounded corners=3pt,BackGray,fill=white] ([xshift=3mm,yshift=-1cm]wul) rectangle ([xshift=-3mm,yshift=-3.7cm]wur);

      % log
      \foreach[count=\i from 0] \Code in {
         {1/A,2/A,6/A,1/B,3/A},
         {1.5/B,3/A,2/A,2/A,1/A},
         {1.5/B,2/A,3/A,1/A,2/A,3/A,1/A},
         {1.5/B,4/A,1/A},
         {1.5/B,3/A,2/A,2/A,1/A},
         {1.5/B,3/A,1/A,4/A,1/A},
         {},
         {1/A,2/A,6/A},
         {1/A,2/A,3/A,1.5/A,2.5/A},
      } {
         \def\XShift{5}
         \foreach \CW/\Style in \Code {
            \ifstrequal{\Style}{B}{\def\RandomSuffix{0}}{\def\RandomSuffix{(rand*0.4mm+0.75mm)}}
            \pgfmathsetmacro\w{3*\CW mm+\RandomSuffix}
            \path[\Style] ([yshift=-2.5mm-1cm,xshift=3.25mm+\XShift pt]wul|-0,-\i*0.28*10mm+1mm) rectangle ++(\w pt,-1.75mm);

            \pgfmathsetmacro{\XShift}{\XShift+\w pt+1mm}
            \xdef\XShift{\XShift}
         }
      }

      % slider
      \draw[Line-Of-Text=SoftTextGray,rounded corners=.325mm] ([yshift=-2cm+3mm,xshift=-4mm]wur) rectangle ++(-.75mm,-1cm);

      % head
      \fill[Line-Of-Text=BackGray] ([yshift=1.35mm,xshift=4pt]wul) rectangle ++(5mm,-1.27mm);
      \fill[Line-Of-Text=BackGray] ([yshift=1.35mm,xshift=4pt+6.5mm]wul) rectangle ++(1cm,-1.27mm);
      \node[above left,BackGray] at([yshift=-1.33mm,xshift=-1mm]wur) {\smash{\scalebox{.9}{\scriptsize\faAngleDown~~\faAngleUp~~\faTimesCircle}}};
   \endscope
\end{tikzpicture}
\end{lrbox}
\newsavebox\CodeFile
\begin{lrbox}{\CodeFile}
\scalebox{1.45}{%
\begin{tikzpicture}
   \draw[rounded corners=1.5pt,fill=white] (0,0) |- ++(.6,-.8) [sharp corners] -- ++(0,.6) -- ++(-.2,.2) coordinate (@rl) [rounded corners=2pt] -- cycle (@rl) |- ++(.2,-.2);
   \draw[thick,line cap=round,lightgray] (.1,-.1) -- ++(.2,0)
      % for what have I written random code generation? :C 
      (.1,-.15) -- ++(.1,0) ++(.05,0) -- ++(.1,0)
      (.125,-.2) -- ++(.15,0)++(.05,0)--++(.025,0)
      (.1,-.25) -- ++(.3,0)
      (.125,-.3) --++(.2,0)++(.05,0)--++(.05,0)
      (.125,-.35) --++(.15,0)++(.05,0)--++(.1,0)
      (.15,-.4)--++(.2,0)
      (.15,-.4)--++(.1,0)++(.05,0)--++(.05,0)
      (.125,-.45)--++(.05,0)
      (.1,-.5)--++(.066,0)++(.05,0)--++(.15,0)
      (.1,-.6)--++(.15,0)++(.05,0)--++(.15,0)
      (.1,-.65)--++(.2,0)
      (.1,-.7)--++(.1,0)++(.05,0)--++(.15,0)
   ;
\end{tikzpicture}}
\end{lrbox}

\begin{frame}{\strut A First Look}
% they take input, textual, syntactical, semantic (call graphs, pdg, ...), metadata, historical information, requirements, annotations (types, contracts), ...
\vspace*{.5em}\hspace*{-3.5mm}
\begin{tikzpicture}[o/.style={outer sep=0pt,inner sep=0pt}]
   \onslide<2->{%
      \node[o] (@) at (0,0) {\usebox\CodeFile};
      \node[above=2.5mm,xshift=1.15mm,gray] at(@.north) {\tiny They take \textbf{\normalsize Input}};
   }
   \pgfonlayer{background}
   \onslide<2->{%
   \scope[transparency group,opacity=.4]
   \node[o,rotate around={-30:(@.south east)},anchor=south east] at(@.south east) {\usebox\CodeFile};
   \node[o,rotate around={-12:(@.south east)},anchor=south east] at(@.south east) {\usebox\CodeFile};
   \endscope}
   \endpgfonlayer
   \begin{uncoverenv}<3->
   \coordinate (@) at(@.east);
   \foreach[count=\i] \usecase/\targeti in {{\raisebox{1pt}{Textual}}/4,Syntactical/5, Semantical/6, Historical/7, Annotated/8, {\only<-9|handout:0>{\ldots}\only<10->{\raisebox{-3pt}{Metadata,~\ldots}}}/9} { % program spectra, hardware, contexts, ...
   \pgfmathsetmacro\rot{-24*\i+66}
      \onslide<\targeti->{
         \path ([xshift=.5mm]@.east)++(\rot+10:1mm) coordinate (@a);
         \fill[opacity=.18,gray] (@a.east) -- ++(\rot:1.5cm) arc (\rot:\rot+20:1.5cm) -- cycle;
         \draw[thick,gray] (@a.east)++(\rot:1.5cm) arc (\rot:\rot+20:1.5cm);
         \path (@a.east) -- ++(1.05*\rot+10:1.6cm) node[right,font=\small,darkgray] (@uc-\i) {\vphantom{a}\smash{\usecase}};
      }
   }
   \node[above=1.65mm,xshift=1mm,gray] (@perspective-label) at(current bounding box.north) {\tiny And use \textbf{\normalsize Perspectives} \rlap{(often combined)}};
   \end{uncoverenv}
   \onslide<11->{%
      \draw[Kite-,gray] ([xshift=6.25mm,yshift=-1mm]current bounding box.south) to[out=-90,in=0] ++(-4.5mm,-5mm) node[below left,yshift=.42\baselineskip,align=right,text width=2.5cm,font=\tiny] {Some of those are the result of other static or dynamic analyses};
   }
   \begin{uncoverenv}<12->
      \node[right,yshift=-2mm,xshift=1cm,align=left,font=\small,darkgray,text width=3.25cm] (@techn) at(current bounding box.east){{\onslide<13->{\subnode{tc-search}{Text/Code Search}\strut}}~\\[4mm]\strut{\onslide<14->{\subnode{clustering}{Clustering}}}~\\[4mm]\strut{\onslide<15->{\subnode{ai}{Abstract Domains}}}~\\[4mm]\strut{\onslide<16->{\subnode{df-constraints}{Dataflow Constraints}}}~\\[1mm]\strut{\onslide<16->{\centerline{\footnotesize\(\vdots\)}}}};
      \onslide<12->{
         \node[above=2.5mm,gray,xshift=-4.5mm] at(@techn.north) {\tiny To apply \textbf{\normalsize Theory}};
      }
   \end{uncoverenv}
   \scope[gray,line cap=round]
   \only<17->{
      \draw ([yshift=1.5pt]@uc-1.east) -- ([yshift=-2.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-2.east) -- ([yshift=-2.5mm]@techn.north west);
      \draw[densely dotted] ([yshift=1.5pt]@uc-3.east) -- ([yshift=-2.5mm]@techn.north west);
   }
   \only<18->{
      \draw ([yshift=1.5pt]@uc-1.east) -- ([yshift=-10.5mm]@techn.north west);
      \draw ([yshift=0pt]@uc-2.east) -- ([yshift=-10.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-4.east) -- ([yshift=-10.5mm]@techn.north west);
      
      \draw ([yshift=-1pt]@uc-2.east) -- ([yshift=-18.5mm]@techn.north west);
      \draw ([yshift=-1pt]@uc-3.east) -- ([yshift=-18.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-5.east) -- ([yshift=-18.5mm]@techn.north west);
      
      \draw ([yshift=-1pt]@uc-2.east) -- ([yshift=-26mm]@techn.north west);
      \draw ([yshift=-1pt]@uc-3.east) -- ([yshift=-26mm]@techn.north west);
   }
   \endscope
   \begin{uncoverenv}<19->
      
      \onslide<20->{\node[right=7.5mm] (@) at(current bounding box.east) {\resizebox*!{2.85cm}{\usebox\UiBox}};
      \scope[transparency group,opacity=.5,every path/.append style={line cap=round,line width=.5pt}]
         \draw[-Kite,gray] ([yshift=-2.5mm,xshift=-6.5mm]@techn.north east) to[out=0,in=180] ([xshift=1.5mm,yshift=-6.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-10.5mm,xshift=-18.5mm]@techn.north east) to[out=0,in=180] ([xshift=7.15mm,yshift=-1.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-18.5mm,xshift=-6.25mm]@techn.north east) to[out=0,in=180] ([xshift=26.15mm,yshift=-9.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-26mm,xshift=-2.5mm]@techn.north east) to[out=0,in=180] ([xshift=26.15mm,yshift=-9.35mm]@.west);
      \endscope
      }
      \onslide<21->{
         \pgfinterruptboundingbox
         \node[
            below=3mm,fill=white,fill opacity=.85,
            path fading=circle with fuzzy edge 20 percent,
            text opacity=1,
            align=center,
            inner sep=15.5pt
         ] at(@.north) {%
            Linting\\
            Refactoring\\
            Type Checking\\
            \(\vdots\)
         };
         \endpgfinterruptboundingbox
      }
      \node[above, gray] at(@.north) {\tiny And \textbf{\normalsize Communicate} or \textbf{\normalsize Use} results};
   \end{uncoverenv}
\end{tikzpicture}
\end{frame}

\begin{frame}{\strut Perspectives}
\vspace*{.5em}\hspace*{-3.5mm}
\begin{tikzpicture}[o/.style={outer sep=0pt,inner sep=0pt}]
   \node[o] (@) at (0,0) {\usebox\CodeFile};
   \node[above=2.5mm,xshift=1.15mm,gray] at(@.north) {\tiny They take \textbf{\normalsize Input}};
   \pgfonlayer{background}
   \scope[transparency group,opacity=.4]
   \node[o,rotate around={-30:(@.south east)},anchor=south east] at(@.south east) {\usebox\CodeFile};
   \node[o,rotate around={-12:(@.south east)},anchor=south east] at(@.south east) {\usebox\CodeFile};
   \endscope
   \endpgfonlayer
   \coordinate (@) at(@.east);
   \coordinate (@inp) at(@);
   \foreach[count=\i] \usecase/\targeti in {{\raisebox{1pt}{Textual}}/4,Syntactical/5, Semantical/6, Historical/7, Annotated/8, {\raisebox{-3pt}{Metadata,~\ldots}}/9} { % program spectra, hardware, contexts, ...
   \pgfmathsetmacro\rot{-24*\i+66}
         \path ([xshift=.5mm]@.east)++(\rot+10:1mm) coordinate (@a);
         \fill[opacity=.18,gray] (@a.east) -- ++(\rot:1.5cm) arc (\rot:\rot+20:1.5cm) -- cycle;
         \draw[thick,gray] (@a.east)++(\rot:1.5cm) arc (\rot:\rot+20:1.5cm);
         \path (@a.east) -- ++(1.05*\rot+10:1.6cm) node[right,font=\small,darkgray] (@uc-\i) {\vphantom{a}\smash{\usecase}};
   }
   \node[above=1.65mm,xshift=1mm,gray] (@perspective-label) at(current bounding box.north) {\tiny And use \textbf{\normalsize Perspectives} \rlap{(often combined)}};
      \draw[Kite-,gray] ([xshift=6.25mm,yshift=-1mm]current bounding box.south) to[out=-90,in=0] ++(-4.5mm,-5mm) node[below left,yshift=.42\baselineskip,align=right,text width=2.5cm,font=\tiny] {Some of those are the result of other static or dynamic analyses};
      \node[right,yshift=-2mm,xshift=1cm,align=left,font=\small,darkgray,text width=3.25cm] (@techn) at(current bounding box.east){{{\subnode{tc-search}{Text/Code Search}\strut}}~\\[4mm]\strut{{\subnode{clustering}{Clustering}}}~\\[4mm]\strut{{\subnode{ai}{Abstract Domains}}}~\\[4mm]\strut{{\subnode{df-constraints}{Dataflow Constraints}}}~\\[1mm]\strut{{\centerline{\footnotesize\(\vdots\)}}}};
         \node[above=2.5mm,gray,xshift=-4.5mm] at(@techn.north) {\tiny To apply \textbf{\normalsize Theory}};
   \scope[gray,line cap=round]
      \draw ([yshift=1.5pt]@uc-1.east) -- ([yshift=-2.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-2.east) -- ([yshift=-2.5mm]@techn.north west);
      \draw[densely dotted] ([yshift=1.5pt]@uc-3.east) -- ([yshift=-2.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-1.east) -- ([yshift=-10.5mm]@techn.north west);
      \draw ([yshift=0pt]@uc-2.east) -- ([yshift=-10.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-4.east) -- ([yshift=-10.5mm]@techn.north west);
      
      \draw ([yshift=-1pt]@uc-2.east) -- ([yshift=-18.5mm]@techn.north west);
      \draw ([yshift=-1pt]@uc-3.east) -- ([yshift=-18.5mm]@techn.north west);
      \draw ([yshift=1.5pt]@uc-5.east) -- ([yshift=-18.5mm]@techn.north west);
      
      \draw ([yshift=-1pt]@uc-2.east) -- ([yshift=-26mm]@techn.north west);
      \draw ([yshift=-1pt]@uc-3.east) -- ([yshift=-26mm]@techn.north west);
   \endscope
      \node[right=7.5mm] (@) at(current bounding box.east) {\resizebox*!{2.85cm}{\usebox\UiBox}};
      \scope[transparency group,opacity=.5,every path/.append style={line cap=round,line width=.5pt}]
         \draw[-Kite,gray] ([yshift=-2.5mm,xshift=-6.5mm]@techn.north east) to[out=0,in=180] ([xshift=1.5mm,yshift=-6.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-10.5mm,xshift=-18.5mm]@techn.north east) to[out=0,in=180] ([xshift=7.15mm,yshift=-1.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-18.5mm,xshift=-6.25mm]@techn.north east) to[out=0,in=180] ([xshift=26.15mm,yshift=-9.35mm]@.west);
         \draw[-Kite,gray] ([yshift=-26mm,xshift=-2.5mm]@techn.north east) to[out=0,in=180] ([xshift=26.15mm,yshift=-9.35mm]@.west);
      \endscope
      \node[above, gray] at(@.north) {\tiny And \textbf{\normalsize Communicate} or \textbf{\normalsize Use} results};
\onslide<2->{
   \node[fit={
      (@uc-1)
      (@uc-2)
      (@uc-3)
      (@uc-4)
      (@uc-5)
      ([yshift=-1mm]@uc-6.south)
      (@inp)
      (@perspective-label.north)
      ([xshift=14mm]@perspective-label.east)
      (@perspective-label.west)
   }] (@) {};
   \fill[white,opacity=.9,even odd rule]
      (current bounding box.south east)
         rectangle
      ([yshift=3mm]current bounding box.north west)
      (@.north west)
         rectangle
      (@.south east);
   \draw[ultra thick,red,rounded corners=6pt]
      (@.north west)
         rectangle
      (@.south east);
}
\pgfinterruptboundingbox
\onslide<3->{
   \node[above right,xshift=8mm,Rect,align=left] (@textual) at(@.north east) {\bIndexR{x <- sin(y) * z}};
   \node[below right,yshift=1mm] at(@textual.south west) {\scriptsize\textsb{Textual Perspective}};
}
\onslide<4->{
   % TODO: syntactical, then semantical, ...
}
\endpgfinterruptboundingbox
\end{tikzpicture}
\end{frame}

\begin{frame}
   TODO: move sample run through
   TODO: perspectives alongside style checks etc, increasing complexity
   TODO: history
\end{frame}

\begin{frame}
TODO: show confusion matrix here
\end{frame}


\renewcommand*{\bibfont}{\tiny}

\AtBeginSection{}
\begin{frame}[allowframebreaks]{References}
   \printbibliography[title={}] % TODO
\end{frame}

\end{document}